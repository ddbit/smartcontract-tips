---
layout: post
title: 'Protocollo di lending DeFi basato su ZkSync EraLend sotto attacco: persi $3.4M'
date: 2023-07-29 11:48:11.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
category: Case Study
tags: []
permalink: "/articoli/protocollo-di-prestito-basato-su-zksync-eralend-sotto-attacco-scoperta-di-una-perdita-di-34-milioni-di-dollari/"
excerpt: 'EraLend, un importante protocollo di lending decentralizzato che opera sulla
  rete zkSync Layer 2, √® stato bersaglio di un "read only reentrancy exploit", che
  ha comportato una perdita significativa di circa 3,4 milioni di dollari. EraLend
  √® un protocollo innovativo nel panorama DeFi, offrendo un protocollo all''avanguardia
  che privilegia l''efficienza del capitale e la riduzione del rischio. Basato su
  zkSync, EraLend supporta praticamente tutti i token pi√π importanti, facilitando
  il prestito peer-to-peer con eccezionale velocit√† e costi minimi. '
image: /featured_images/Screenshot2023-07-29at13.17.25.png
---
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width: 728px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="position: relative; padding-bottom: 55.63187026977539%; overflow: hidden; -webkit-mask-image: -webkit-radial-gradient(white, black);"></p>
</div>
</div>
<p><img style="display: block; object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%;" src="{{ site.baseurl }}/assets/2023/07/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari" sizes="100vw" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari?format=2500w 2500w" alt="protocollo defi attaccato persi 3.4 milioni di dollari" width="728" height="405" data-stretch="false" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/ca8d5125-c9a0-4f64-ab24-d4e13e20e61e/protocollo+defi+attaccato+persi+3.4+milioni+di+dollari" data-image-dimensions="728x405" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<h2 style="white-space: pre-wrap;">Overview</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">EraLend, un importante protocollo di lending decentralizzato che opera sulla rete zkSync Layer 2, √® stato bersaglio di un "read only reentrancy exploit", che ha comportato una perdita significativa di circa 3,4 milioni di dollari.</p>
<h2 style="white-space: pre-wrap;">Informazioni su EraLend</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">EraLend √® un protocollo innovativo nel panorama DeFi, offrendo un protocollo all'avanguardia che privilegia l'efficienza del capitale e la riduzione del rischio. Basato su zkSync, EraLend supporta praticamente tutti i token pi√π importanti, facilitando il prestito peer-to-peer con eccezionale velocit√† e costi minimi.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">EraLend fa da apripista con la prima suite nativa di prodotti di lending su zkSync, con l'obiettivo di favorire l'adozione di massa del DeFi.</p>
<h2 style="white-space: pre-wrap;">Sull'attacco</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">L'attaccante ha sfruttato una vulnerabilit√† nel codice dello smart contract che gli ha permesso di eseguire chiamate reiterate a una funzione all'interno di una singola transazione. Questo gli ha consentito di prelevare pi√π fondi di quelli a cui avrebbe avuto diritto, esaurendo le risorse in due transazioni distinte utilizzando un wallet di tipo EOA (External Owned Account)"</p>
</div>
<div class="<br />
          image-block-outer-wrapper<br />
          layout-caption-below<br />
          design-layout-inline<br />
          combination-animation-site-default<br />
          individual-animation-site-default<br />
          individual-text-animation-site-default<br />
        " data-test="image-block-inline-outer-wrapper"><br />
<figure class="<br />
              sqs-block-image-figure<br />
              intrinsic<br />
            " style="max-width: 729px;">
<div class="image-block-wrapper" data-animation-role="image">
<div class="sqs-image-shape-container-element</p>
<p>              has-aspect-ratio<br />
            " style="position: relative; padding-bottom: 48.0109748840332%; overflow: hidden; -webkit-mask-image: -webkit-radial-gradient(white, black);"></p>
</div>
</div>
<p><img style="display: block; object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%;" src="{{ site.baseurl }}/assets/2023/07/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni" sizes="100vw" srcset="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=100w 100w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=300w 300w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=500w 500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=750w 750w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni?format=2500w 2500w" alt="transazioni attacco eralend protocollo defi persi 3.4 milioni" width="729" height="350" data-stretch="false" data-image="https://images.squarespace-cdn.com/content/v1/640a182d9182d66162be74d6/7f2a3810-110f-43b1-8f0b-0904164cff54/transazioni+attacco+eralend+protocollo+defi+persi+3.4+milioni" data-image-dimensions="729x350" data-image-focal-point="0.5,0.5" data-load="false" data-loader="sqs" /></p>
</figure>
</div>
<div class="sqs-html-content">
<p class="sqsrte-large" style="white-space: pre-wrap;">In particolare, l'exploit ha comportato la manipolazione di un contratto per segnalare valori obsoleti che non erano ancora stati aggiornati. Di conseguenza, ci√≤ ha avuto ripercussioni sulla stablecoin USDC+, emessa dal protocollo Overnight Finance, determinando una perdita potenziale di oltre $261.000, che rappresenta circa il 7,86% del valore totale del collateral a supporto della stablecoin. EraLend ha twittato sull'exploit per informare gli utenti:</p>
<blockquote>
<p class="sqsrte-large" style="white-space: pre-wrap;">üö®Security Update: We've experienced a security incident on our platform today. The threat has been contained. We've suspended all borrowing operations for now and advise against depositing USDC. We're working with partners and cybersecurity firms to address this.<br />
More updates‚Ä¶</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">‚Äî EraLend | The #1 Money Market on zkSyncü•á (@Era_Lend) <a href="https://twitter.com/Era_Lend/status/1683826465446715397?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">July 25, 2023</a></p>
</blockquote>
<p class="sqsrte-large" style="white-space: pre-wrap;">In risposta all'attacco, EraLend ha agito immediatamente sospendendo i contratti zkSync del protocollo per limitare o impedire ulteriori exploit. E‚Äô stato anche consigliato agli utenti di non depositare USDC fino a quando il problema non fosse stato risolto. Anche le operazioni di prestito sulla piattaforma sono state temporaneamente interrotte poich√© il team collabora con alcune societ√† di sicurezza informatica per affrontare l‚Äôincidente.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">La strategia di attacco sfruttata √® un ‚Äúread-only reentrancy exploit‚Äù, un metodo che non altera lo stato di un contratto ma √® riuscito a drenare una notevole quantit√† di denaro dalla piattaforma. valori di data utilizzando un difetto nella "funzione callback e _updateReserves".</p>
<blockquote>
<p class="sqsrte-large" style="white-space: pre-wrap;">We are assisting <a href="https://twitter.com/Era_Lend?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">@Era_Lend</a> to this issue, and the root cause has been identified. The total loss is ~$3.4M.<br />
Specifically, this is a read-only re-entrancy attack.<br />
Another attack tx is:<a href="https://t.co/H4A2suVLai" target="_blank" rel="noopener">https://t.co/H4A2suVLai</a><br />
Attacker address:<br />
0xf1D076c9Be4533086f967e14EE6aFf204D5ECE7a <a href="https://t.co/InhCCW7QAy" target="_blank" rel="noopener">https://t.co/InhCCW7QAy</a></p>
<p class="sqsrte-large" style="white-space: pre-wrap;">‚Äî BlockSec (@BlockSecTeam) <a href="https://twitter.com/BlockSecTeam/status/1683824959452504065?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">July 25, 2023</a></p>
</blockquote>
<h2 style="white-space: pre-wrap;">Ancora sull'attacco</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">L'attacco a EraLend ha sfruttato principalmente i token LP (Liquidity Pool) come collaterale. L'attaccante √® stato in grado di manipolare il prezzo dei token LP, causando perdite significative. L'exploit potrebbe essere avvenuto perch√© EraLend consentiva l'utilizzo di questi token LP come collaterale.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">Inoltre, l'attacco a EraLend ha avuto un effetto a catena su altre piattaforme all'interno dell'ecosistema, in particolare Overnight.fi. Quest'ultima utilizzava EraLend in modo simile ad Aave, dove prendevano in prestito ETH contro USDC e fornivano posizioni LP delta-neutral su Mute.io. A seguito dell'attacco, la posizione USDC/ETH LP di Overnight.fi su Mute.io, legata a EraLend, ha subito una diminuzione del valore, spingendo gli utenti a vendere le loro partecipazioni sulla piattaforma. Overnight.fi ha successivamente interrotto temporaneamente l'uso di USD+ su zkSync e sta collaborando con EraLend per massimizzare gli sforzi di recupero.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">Inoltre, Peckshield, la nota societ√† di auditing, ha confermato un problema di price oracle legato all'exploit. Questo strumento, critico per determinare i prezzi di mercato attuali, ha subito interruzioni a causa dell'attacco, portando a incongruenze nei calcoli.</p>
<h2 style="white-space: pre-wrap;">Conseguenze dell'attacco</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">Sebbene la perdita totale subita da EraLend ammonti a circa $3,4 milioni, √® stata segnalata una seconda transazione di attacco che coinvolge $1 milione di USDC. Questo solleva preoccupazioni riguardo a potenziali ulteriori perdite, evidenziando la gravit√† della situazione.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">Dopo aver identificato l'exploit, EraLend ha prontamente rilasciato una dichiarazione riconoscendo l'incidente di sicurezza e assicurando ai propri utenti che la minaccia era stata contenuta. Il protocollo ha sospeso tutte le operazioni di prestito e ha consigliato agli utenti di non depositare USDC fino a quando la situazione non fosse stata risolta. EraLend ha inoltre assicurato ai propri utenti che tutti gli asset diversi da USDC sono rimasti sicuri.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">Tuttavia, questo incidente ha suscitato preoccupazioni riguardo alle vulnerabilit√† potenziali che possono esistere nell'ampio ecosistema DeFi. Rappresenta un potente monito sull'importanza di robuste misure di sicurezza e vigilanza costante nel mondo delle finanze decentralizzate.</p>
<h2 style="white-space: pre-wrap;">Prevenzione di futuri attacchi</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">A seguito dell'attacco, sviluppatori ed esperti del settore hanno sottolineato l'importanza di implementare corrette tecniche di codifica per prevenire tali violazioni di sicurezza. Una misura preventiva di questo tipo √® una tecnica chiamata "checks-effects-interactions," che garantisce che uno smart contract verifichi sempre tutte i valori attesi e le condizioni prima di eseguire eventuali modifiche dello stato, quindi esegue tutte le modifiche dello stato prima di interagire con altri contratti.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">Attraverso questo incidente, EraLend ha dimostrato impegno nel mantenere gli standard di sicurezza pi√π elevati e nel prendere misure pro-attive per proteggere i fondi dei propri utenti. Il team sta collaborando con partner e aziende di sicurezza informatica per affrontare le problematiche e mitigare l'impatto dell'attacco.</p>
<p class="sqsrte-large" style="white-space: pre-wrap;">L'impegno di EraLend nel rafforzare la propria infrastruttura di sicurezza, nonostante il contraccolpo, rafforza la dedizione del protocollo alla propria comunit√† di utenti e all'ampio ecosistema DeFi.</p>
<h2 style="white-space: pre-wrap;">Conclusione</h2>
<p class="sqsrte-large" style="white-space: pre-wrap;">In conclusione, l'exploit recente di EraLend sottolinea l'urgente necessit√† di maggiori misure di sicurezza nella DeFi. Nonostante il contraccolpo, EraLend rimane salda nel rafforzare i propri protocolli per proteggere gli utenti. L'incidente non mette alla prova solo EraLend, ma serve anche come vivo monito per l'ecosistema DeFi nel suo complesso riguardo all‚Äôattenzione sulle vulnerabilit√† e alle buone pratiche per scrivere codice sicuro.</p>
</div>
